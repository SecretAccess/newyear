<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãŠå¹´ç‰æŠ½é¸ãƒ„ãƒ¼ãƒ«</title>
  <!-- ã‚¹ãƒãƒ›å¯¾å¿œ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(to right, #ffecd2, #fcb69f);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      text-align: center;
      background-color: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      width: 95%;
      max-width: 480px;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #ff4500;
    }
    .select-wrapper {
      margin-bottom: 20px;
    }
    label {
      font-size: 1rem;
      margin-right: 5px;
    }
    select {
      font-size: 1rem;
      padding: 6px 10px;
      border-radius: 5px;
    }
    button {
      padding: 12px 20px;
      font-size: 1rem;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin: 10px 5px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    button:hover:enabled {
      background-color: #45a049;
    }
    #drawArea {
      margin-top: 15px;
      min-height: 200px; /* çµæœè¡¨ç¤ºã‚¹ãƒšãƒ¼ã‚¹ */
    }
    .slot {
      display: inline-block;
      margin: 5px;
      text-align: center;
      vertical-align: top;
      width: 80px;
      height: 110px;
      position: relative;
    }
    .slot img {
      width: 60px;
      height: auto;
      transition: transform 0.3s;
    }
    .slot img:hover {
      transform: scale(1.1);
    }
    .slot .amount-label {
      display: block;
      font-size: 0.9rem;
      margin-top: 3px;
      color: #333;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ‰ãŠå¹´ç‰æŠ½é¸(10é€£ã‚¬ãƒãƒ£)ğŸ‰</h1>

  <!-- å­¦å¹´åŒºåˆ†é¸æŠ -->
  <div class="select-wrapper">
    <label for="gradeSelect">å­¦å¹´ã‚’é¸æŠï¼š</label>
    <select id="gradeSelect">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option value="æœªå°±å­¦å…">æœªå°±å­¦å…</option>
      <option value="å°1">å°1</option>
      <option value="å°2">å°2</option>
      <option value="å°3">å°3</option>
      <option value="å°4">å°4</option>
      <option value="å°5">å°5</option>
      <option value="å°6">å°6</option>
      <option value="ä¸­1">ä¸­1</option>
      <option value="ä¸­2">ä¸­2</option>
      <option value="ä¸­3">ä¸­3</option>
      <option value="é«˜æ ¡ç”Ÿä»¥ä¸Š">é«˜æ ¡ç”Ÿä»¥ä¸Š</option>
    </select>
  </div>

  <!-- 10é€£ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ -->
  <button id="drawButton" disabled>10é€£ã‚¬ãƒãƒ£ã‚’å›ã™</button>

  <!-- ã‚¬ãƒãƒ£çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="drawArea"></div>
</div>

<script>
//===================================================================
// 1) ç´™å¹£/ãƒã‚ºãƒ¬ ç”»åƒãƒãƒƒãƒ—
//===================================================================
const imageMap = {
  1000: 'kitasato.png',
  5000: 'umeko.png',
  10000: 'shibusawa.png',
  hazure: 'hazure.png'
};

//===================================================================
// 2) ãƒ¡ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³(70%)ã¨ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³(30%)ã‚’å„å­¦å¹´åŒºåˆ†ã«å®šç¾©
//   (çœç•¥ãªã—å®Œå…¨ç‰ˆã€å„å­¦å¹´ãƒ¡ã‚¤ãƒ³1ã¤+ã‚µãƒ–10å€‹ãšã¤ã€comboã¯ã™ã¹ã¦è¦ç´ 10å€‹)
//===================================================================
const patternByGrade = {
  // --- ä»¥ä¸‹ã¯å‰ã®å›ç­”ã®å®Œå…¨ç‰ˆã‚’ã‚³ãƒ”ãƒš ---
  "æœªå°±å­¦å…": {
    main: {
      combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°1": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°2": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°3": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°4": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°5": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "å°6": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "ä¸­1": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "ä¸­2": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
 "ä¸­3": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },
  "é«˜æ ¡ç”Ÿä»¥ä¸Š": {
    main: {
      combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
    ]
  }
};

//---------------------------------------------------------
// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
//---------------------------------------------------------
const gradeSelect = document.getElementById('gradeSelect');
const drawButton  = document.getElementById('drawButton');
const drawArea    = document.getElementById('drawArea');

gradeSelect.addEventListener('change', () => {
  drawButton.disabled = (gradeSelect.value === "");
});

//---------------------------------------------------------
// 10é€£ã‚¬ãƒãƒ£ã‚’å›ã™ (éåŒæœŸå•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã« currentIndex ã‚’ä½¿ç”¨)
//---------------------------------------------------------
drawButton.addEventListener('click', () => {
  drawArea.innerHTML = ''; // ãƒªã‚»ãƒƒãƒˆ

  const gradeData = patternByGrade[gradeSelect.value];
  if (!gradeData) return;

  // ãƒ¡ã‚¤ãƒ³ or ã‚µãƒ– ã‚’ç¢ºç‡ã§é¸ã¶
  const r = Math.random();
  let finalCombo;
  if (r <= gradeData.main.prob) {
    finalCombo = gradeData.main.combo;
  } else {
    const subs = gradeData.subs;
    const x = (r - gradeData.main.prob) / 0.30; 
    const idx = Math.floor(x * subs.length);
    finalCombo = subs[idx].combo;
  }

  // ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  const shuffled = shuffleArray(finalCombo.slice());
  const total = calcTotal(finalCombo);

  let index = 0;
  const maxPulls = 10;

  function pullOne() {
    // ãƒ«ãƒ¼ãƒ—çµ‚äº†åˆ¤å®š
    if (index >= maxPulls) {
      setTimeout(() => {
        alert(`10é€£ã‚¬ãƒãƒ£çµ‚äº†ï¼ åˆè¨ˆï¼š${total}å††`);
      }, 400);
      return;
    }

    // ä»Šã®indexã‚’ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã«ä¿å­˜ (setTimeoutã®ã‚ºãƒ¬ã‚’é˜²ã)
    const currentIndex = index;
    index++;

    // ã‚¹ãƒ­ãƒƒãƒˆè¦ç´ ã‚’ä½œæˆ
    const slotDiv = document.createElement('div');
    slotDiv.className = 'slot';
    const img = document.createElement('img');
    const label = document.createElement('span');
    label.className = 'amount-label';

    slotDiv.appendChild(img);
    slotDiv.appendChild(label);
    drawArea.appendChild(slotDiv);

    // 0.3ç§’å¾Œã«çµæœã‚’ç¢ºå®š
    setTimeout(() => {
      const val = shuffled[currentIndex];
      if (val === "hazure") {
        img.src = imageMap.hazure;
        label.textContent = "ãƒã‚ºãƒ¬";
      } else {
        img.src = imageMap[val];
        label.textContent = val + "å††";
      }
    }, 300);

    // æ¬¡ã®æŠ½é¸ã¸ 0.6ç§’å¾Œ
    setTimeout(pullOne, 600);
  }

  pullOne(); // æœ€åˆã®å‘¼ã³å‡ºã—
});

//---------------------------------------------------------
// é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«(Fisher-Yates)
//---------------------------------------------------------
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

//---------------------------------------------------------
// 10å€‹ã®è¦ç´ ã‹ã‚‰åˆè¨ˆé‡‘é¡ã‚’ç®—å‡º
//---------------------------------------------------------
function calcTotal(arrayOf10) {
  let sum = 0;
  for (let val of arrayOf10) {
    if (val !== "hazure") {
      sum += (typeof val === "number" ? val : 0);
    }
  }
  return sum;
}
</script>
</body>
</html>
