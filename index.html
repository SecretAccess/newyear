<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>10連ガチャ風 お年玉抽選ツール</title>
  <!-- スマホ対応 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(to right, #ffecd2, #fcb69f);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      text-align: center;
      background-color: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      width: 95%;
      max-width: 480px;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #ff4500;
    }
    .select-wrapper {
      margin-bottom: 20px;
    }
    label {
      font-size: 1.0rem;
      margin-right: 5px;
    }
    select {
      font-size: 1.0rem;
      padding: 6px 10px;
      border-radius: 5px;
    }
    button {
      padding: 12px 20px;
      font-size: 1.0rem;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin: 10px 5px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    button:hover:enabled {
      background-color: #45a049;
    }
    #drawArea {
      margin-top: 15px;
    }
    .slot {
      display: inline-block;
      margin: 5px;
      text-align: center;
      vertical-align: top;
      width: 90px;
      height: 100px;
      position: relative;
    }
    .slot img {
      width: 70px;
      height: auto;
      transition: transform 0.3s;
    }
    .slot img:hover {
      transform: scale(1.1);
    }
    .slot .amount-label {
      display: block;
      font-size: 0.9rem;
      margin-top: 3px;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🎉 10連ガチャ風 お年玉抽選 🎉</h1>

    <!-- 学年区分選択 -->
    <div class="select-wrapper">
      <label for="gradeSelect">学年を選択：</label>
      <select id="gradeSelect">
        <option value="">選択してください</option>
        <option value="未就学児">未就学児</option>
        <option value="小1">小1</option>
        <option value="小2">小2</option>
        <option value="小3">小3</option>
        <option value="小4">小4</option>
        <option value="小5">小5</option>
        <option value="小6">小6</option>
        <option value="中1">中1</option>
        <option value="中2">中2</option>
        <option value="中3">中3</option>
        <option value="高校生以上">高校生以上</option>
      </select>
    </div>

    <!-- 10連ガチャ開始ボタン -->
    <button id="drawButton" disabled>10連ガチャを回す</button>

    <!-- 抽選結果のスロットエリア -->
    <div id="drawArea"></div>
  </div>

  <script>
    // ==============================================================
    // 1) 学年ごとの「金額+ハズレ」確率設定
    //
    // 例： 未就学児
    //   2000円が70%、 残りは (3000,4000,5000,6000,7000,8000,9000,10000,ハズレ) = 9項目を30%で均等割 → each 3.3333%。
    // ==============================================================
    const distribution = {
      "未就学児": [
        { val: 2000,    prob: 0.70 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 } // ハズレ
      ],
      "小1": [
        { val: 3000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "小2": [
        { val: 3000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "小3": [
        { val: 3000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "小4": [
        { val: 3000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "小5": [
        { val: 3000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "小6": [
        { val: 5000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "中1": [
        { val: 5000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "中2": [
        { val: 5000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "中3": [
        { val: 5000,    prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 10000,   prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ],
      "高校生以上": [
        { val: 10000,   prob: 0.70 },
        { val: 2000,    prob: 0.0333333 },
        { val: 3000,    prob: 0.0333333 },
        { val: 4000,    prob: 0.0333333 },
        { val: 5000,    prob: 0.0333333 },
        { val: 6000,    prob: 0.0333333 },
        { val: 7000,    prob: 0.0333333 },
        { val: 8000,    prob: 0.0333333 },
        { val: 9000,    prob: 0.0333333 },
        { val: 'hzure', prob: 0.0333333 }
      ]
    };

    // 2) 紙幣画像とハズレ画像
    const imageMap = {
      1000: 'kitasato.png',  // 1000円
      5000: 'umeko.png',     // 5000円
      10000: 'shibusawa.png',// 10000円
      hazure: 'hazure.png'
    };

    // ------------------------------------------------
    // DOM取得
    // ------------------------------------------------
    const gradeSelect = document.getElementById('gradeSelect');
    const drawButton  = document.getElementById('drawButton');
    const drawArea    = document.getElementById('drawArea');

    // 学年未選択時はボタン無効
    gradeSelect.addEventListener('change', () => {
      drawButton.disabled = (gradeSelect.value === "");
    });

    // ------------------------------------------------
    // 10連ガチャを回す処理
    // ------------------------------------------------
    drawButton.addEventListener('click', () => {
      drawArea.innerHTML = ''; // リセット

      const grade = gradeSelect.value;
      const dist  = distribution[grade];
      let total   = 0; // 合計金額

      // 10回リズムよく表示
      let index = 0;
      const maxPulls = 10;

      function pullOne() {
        if (index >= maxPulls) {
          // 終了
          setTimeout(() => {
            alert(`10連ガチャ終了！ 合計：${total}円`);
          }, 500);
          return;
        }
        index++;

        // 1) スロット要素をあらかじめ作成（回転アニメ等あればここで対応可）
        const slotDiv = document.createElement('div');
        slotDiv.className = 'slot';
        const img = document.createElement('img');
        img.src = ''; // 後で確定
        const label = document.createElement('span');
        label.className = 'amount-label';

        slotDiv.appendChild(img);
        slotDiv.appendChild(label);
        drawArea.appendChild(slotDiv);

        // 2) 簡単な演出：0.5秒後に結果を確定
        setTimeout(() => {
          const val = drawOneValue(dist); // 1回分の抽選
          if (val === 'hzure') {
            // ハズレ
            img.src = imageMap['hazure'];
            label.textContent = 'ハズレ';
          } else {
            // 当たり(2000〜10000)
            total += val;
            // 表示用に"最大紙幣"を判定
            const biggest = getBiggestBill(val);
            img.src = imageMap[biggest];
            label.textContent = `${val}円`;
          }
        }, 500);

        // 次の抽選へ 1秒後くらいに呼び出す
        setTimeout(pullOne, 1000);
      }
      pullOne();
    });

    // ------------------------------------------------
    // 1回分の抽選
    // ------------------------------------------------
    function drawOneValue(dist) {
      const r = Math.random();
      let cumulative = 0;
      for (let i = 0; i < dist.length; i++) {
        cumulative += dist[i].prob;
        if (r <= cumulative) {
          return dist[i].val;
        }
      }
      // 念のため
      return dist[0].val;
    }

    // ------------------------------------------------
    // 金額 val(2000,3000,...10000) の中で
    // 最大紙幣(1000,5000,10000)を返す
    //   2000 → 1000
    //   3000 → 1000
    //   4000 → 1000
    //   5000 → 5000
    //   6000 → 5000
    //   7000 → 5000
    //   8000 → 5000
    //   9000 → 5000
    //   10000 →10000
    // ------------------------------------------------
    function getBiggestBill(val) {
      if (val === 10000) return 10000;
      if (val >= 5000)   return 5000;
      return 1000; // 2000〜4000
    }
  </script>
</body>
</html>
