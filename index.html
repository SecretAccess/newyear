<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãŠå¹´ç‰æŠ½é¸ãƒ„ãƒ¼ãƒ«</title>
  <!-- ã‚¹ãƒãƒ›å¯¾å¿œ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(to right, #ffecd2, #fcb69f);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      text-align: center;
      background-color: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      width: 95%;
      max-width: 480px;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #ff4500;
    }
    .select-wrapper {
      margin-bottom: 20px;
    }
    label {
      font-size: 1rem;
      margin-right: 5px;
    }
    select {
      font-size: 1rem;
      padding: 6px 10px;
      border-radius: 5px;
    }
    button {
      padding: 12px 20px;
      font-size: 1rem;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin: 10px 5px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    button:hover:enabled {
      background-color: #45a049;
    }
    #drawArea {
      margin-top: 15px;
      min-height: 200px; /* çµæœè¡¨ç¤ºã‚¹ãƒšãƒ¼ã‚¹ */
    }
    .slot {
      display: inline-block;
      margin: 5px;
      text-align: center;
      vertical-align: top;
      width: 80px;
      height: 110px;
      position: relative;
    }
    .slot img {
      width: 60px;
      height: auto;
      transition: transform 0.3s;
    }
    .slot img:hover {
      transform: scale(1.1);
    }
    .slot .amount-label {
      display: block;
      font-size: 0.9rem;
      margin-top: 3px;
      color: #333;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ‰ãŠå¹´ç‰æŠ½é¸(10é€£ã‚¬ãƒãƒ£)ğŸ‰</h1>

  <!-- å­¦å¹´åŒºåˆ†é¸æŠ -->
  <div class="select-wrapper">
    <label for="gradeSelect">å­¦å¹´ã‚’é¸æŠï¼š</label>
    <select id="gradeSelect">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option value="æœªå°±å­¦å…">æœªå°±å­¦å…</option>
      <option value="å°1">å°1</option>
      <option value="å°2">å°2</option>
      <option value="å°3">å°3</option>
      <option value="å°4">å°4</option>
      <option value="å°5">å°5</option>
      <option value="å°6">å°6</option>
      <option value="ä¸­1">ä¸­1</option>
      <option value="ä¸­2">ä¸­2</option>
      <option value="ä¸­3">ä¸­3</option>
      <option value="é«˜æ ¡ç”Ÿä»¥ä¸Š">é«˜æ ¡ç”Ÿä»¥ä¸Š</option>
    </select>
  </div>

  <!-- 10é€£ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ -->
  <button id="drawButton" disabled>10é€£ã‚¬ãƒãƒ£ã‚’å›ã™</button>

  <!-- ã‚¬ãƒãƒ£çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="drawArea"></div>
</div>

<script>
//===================================================================
// 1) ç´™å¹£/ãƒã‚ºãƒ¬ ç”»åƒãƒãƒƒãƒ—
//===================================================================
const imageMap = {
  1000: 'kitasato.png',
  5000: 'umeko.png',
  10000: 'shibusawa.png',
  hazure: 'hazure.png'
};

//===================================================================
// 2) ãƒ¡ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³(70%)ã¨ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³(30%)ã‚’å„å­¦å¹´åŒºåˆ†ã«å®šç¾©
//   - ãƒ¡ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ = å­¦å¹´åˆ¥ã®ä»£è¡¨åˆè¨ˆé‡‘é¡ã‚’ä½œã‚‹10å€‹ã®çµ„ã¿åˆã‚ã›
//   - ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ = ãã®ä»–ã®åˆè¨ˆ(2000/3000/4000/...10000)ã‚’è¤‡æ•°é€šã‚Šç”¨æ„ï¼ˆç´„10é€šã‚Šï¼‰
//   ã“ã“ã§ã¯å„å­¦å¹´ã«ã¤ã
//    ãƒ¡ã‚¤ãƒ³: 1é€šã‚Š
//    ã‚µãƒ–:   10é€šã‚Š
//===================================================================
const patternByGrade = {
  // --------------------------
  //  æœªå°±å­¦å…
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x2 + ãƒã‚ºãƒ¬8 = 2000å††
  // --------------------------
  "æœªå°±å­¦å…": {
    main: {
      combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 3000å††
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 1000Ã—5 =5000å†† åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2) åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°1
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x3 + ãƒã‚ºãƒ¬7 = 3000å††
  // --------------------------
  "å°1": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††(1000Ã—5)
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°2
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x3 + ãƒã‚ºãƒ¬7 = 3000å††
  // --------------------------
  "å°2": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // ä»¥ä¸‹ã€å°1 ã¨åŒã˜æ§‹æˆ
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°3
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x3 + ãƒã‚ºãƒ¬7 = 3000å††
  // --------------------------
  "å°3": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††(1000Ã—5)
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°4
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x3 + ãƒã‚ºãƒ¬7 = 3000å††
  // --------------------------
  "å°4": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††(1000Ã—5)
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°5
  //  ãƒ¡ã‚¤ãƒ³ï¼š 1000x3 + ãƒã‚ºãƒ¬7 = 3000å††
  // --------------------------
  "å°5": {
    main: {
      combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††(1000Ã—5)
      { combo: [1000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  å°6
  //  ãƒ¡ã‚¤ãƒ³ï¼š 5000Ã—1 + ãƒã‚ºãƒ¬9 = 5000å††
  // --------------------------
  "å°6": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 3000å††
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)2å›ç›®
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  ä¸­1
  //  ãƒ¡ã‚¤ãƒ³ï¼š 5000Ã—1 + ãƒã‚ºãƒ¬9 = 5000å††
  // --------------------------
  "ä¸­1": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // å°6ã¨åŒæ§˜
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  ä¸­2
  //  ãƒ¡ã‚¤ãƒ³ï¼š 5000Ã—1 + ãƒã‚ºãƒ¬9 = 5000å††
  // --------------------------
  "ä¸­2": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  ä¸­3
  //  ãƒ¡ã‚¤ãƒ³ï¼š 5000Ã—1 + ãƒã‚ºãƒ¬9 = 5000å††
  // --------------------------
 "ä¸­3": {
    main: {
      combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††ï¼ˆ1000Ã—2ï¼‰
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 3000å††ï¼ˆ1000Ã—3ï¼‰
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††ï¼ˆ1000Ã—4ï¼‰
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 7000å††ï¼ˆ5000 + 1000Ã—2ï¼‰
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††ï¼ˆ5000 + 1000Ã—3ï¼‰
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††ï¼ˆ5000 + 1000Ã—4ï¼‰
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
      // 10000å††(1æš)
      { combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2) åˆ¥ã‚¢ãƒ¬ãƒ³ã‚¸
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
    ]
  },

  // --------------------------
  //  é«˜æ ¡ç”Ÿä»¥ä¸Š
  //  ãƒ¡ã‚¤ãƒ³ï¼š 10000Ã—1 + ãƒã‚ºãƒ¬9 = 10000å††
  // --------------------------
  "é«˜æ ¡ç”Ÿä»¥ä¸Š": {
    main: {
      combo: [10000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"],
      prob: 0.70
    },
    subs: [
      // 2000å††
      { combo: [1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 3000å††
      { combo: [1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 4000å††
      { combo: [1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 5000å††
      { combo: [5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 6000å††
      { combo: [5000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 7000å††
      { combo: [5000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 8000å††
      { combo: [5000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 9000å††
      { combo: [5000,1000,1000,1000,1000,"hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(5000Ã—2)
      { combo: [5000,5000,"hazure","hazure","hazure","hazure","hazure","hazure","hazure","hazure"] },
      // 10000å††(1000Ã—10)
      { combo: [1000,1000,1000,1000,1000,1000,1000,1000,1000,1000] },
    ]
  }
};

//---------------------------------------------------------
// DOMã®å–å¾—
//---------------------------------------------------------
const gradeSelect = document.getElementById('gradeSelect');
const drawButton  = document.getElementById('drawButton');
const drawArea    = document.getElementById('drawArea');

// å­¦å¹´æœªé¸æŠãªã‚‰ãƒœã‚¿ãƒ³ç„¡åŠ¹
gradeSelect.addEventListener('change', () => {
  drawButton.disabled = (gradeSelect.value === "");
});

//---------------------------------------------------------
// 10é€£ã‚¬ãƒãƒ£ã‚’å›ã™
//---------------------------------------------------------
drawButton.addEventListener('click', () => {
  drawArea.innerHTML = ''; // ãƒªã‚»ãƒƒãƒˆ

  const gradeData = patternByGrade[gradeSelect.value];
  if (!gradeData) return;

  // 1) ã€Œãƒ¡ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€(prob=0.70) ã‹ã€Œã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã€(30%ã‚’åˆ†å‰²) ã®ã„ãšã‚Œã‹ã‚’é¸ã¶
  const r = Math.random();
  let finalCombo;
  if (r <= gradeData.main.prob) {
    finalCombo = gradeData.main.combo;
  } else {
    // ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰1ã¤å‡ç­‰ã«é¸ã¶
    const subs = gradeData.subs;
    // ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯åˆè¨ˆã§30% â†’ ãã‚Œã‚’ subs.length ã§å‡ç­‰å‰²ã‚Š (1ã‚µãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚ãŸã‚Š => 0.30 / subs.length)
    // ä¾‹: subsãŒ10å€‹ãªã‚‰1ã¤ã‚ãŸã‚Š3%
    const x = (r - gradeData.main.prob) / 0.30; // 0ã€œ1 ã®ç¯„å›²ã«æ­£è¦åŒ–
    const idx = Math.floor(x * subs.length);    // 0ã€œ(subs.length-1)
    finalCombo = subs[idx].combo;
  }

  // 2) é †åºã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦ãƒªã‚ºãƒ ã‚ˆãè¡¨ç¤º
  const shuffled = shuffleArray(finalCombo.slice());
  const total = calcTotal(finalCombo); // åˆè¨ˆé‡‘é¡(ä¸¦ã³é †é–¢ä¿‚ãªã)

  let index = 0;
  const maxPulls = 10;

  function pullOne() {
    if (index >= maxPulls) {
      // 10å›çµ‚äº†å¾Œã«åˆè¨ˆé‡‘é¡ã‚’è¡¨ç¤º
      setTimeout(() => {
        alert(`ã‚ãªãŸã®ä»Šå¹´ã®ãŠå¹´ç‰ã¯${total}å††`);
      }, 400);
      return;
    }

    // ã‚¹ãƒ­ãƒƒãƒˆè¦ç´ ã‚’ä½œæˆ
    const slotDiv = document.createElement('div');
    slotDiv.className = 'slot';
    const img = document.createElement('img');
    img.src = '';
    const label = document.createElement('span');
    label.className = 'amount-label';

    slotDiv.appendChild(img);
    slotDiv.appendChild(label);
    drawArea.appendChild(slotDiv);

    // 0.3ç§’å¾Œã«çµæœç¢ºå®š
    setTimeout(() => {
      const val = shuffled[index];
      if (val === "hazure") {
        img.src = imageMap["hazure"];
        label.textContent = "ãƒã‚ºãƒ¬";
      } else {
        img.src = imageMap[val];
        label.textContent = val + "å††";
      }
    }, 300);

    index++;
    // æ¬¡ã®ã‚¹ãƒ­ãƒƒãƒˆã‚’ 0.6ç§’å¾Œã«
    setTimeout(pullOne, 600);
  }
  pullOne();
});

//---------------------------------------------------------
// é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«(Fisher-Yates)
//---------------------------------------------------------
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

//---------------------------------------------------------
// 10å€‹ã®è¦ç´ ã‹ã‚‰åˆè¨ˆé‡‘é¡ã‚’ç®—å‡º
//---------------------------------------------------------
function calcTotal(arrayOf10) {
  let sum = 0;
  for (let val of arrayOf10) {
    if (val !== "hazure") {
      sum += (typeof val === "number" ? val : 0);
    }
  }
  return sum;
}
</script>
</body>
</html>
